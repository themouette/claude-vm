[capability]
id = "chromium"
name = "Chromium Browser"
description = "Headless Chromium for web automation and testing"

[packages]
system = ["chromium", "fonts-liberation", "xvfb"]

[[phase.setup]]
name = "chromium-symlinks"
script = """
#!/bin/bash
set -e
# Create symlinks for compatibility with tools looking for google-chrome
sudo ln -sf /usr/bin/chromium /usr/bin/google-chrome
sudo ln -sf /usr/bin/chromium /usr/bin/google-chrome-stable
sudo mkdir -p /opt/google/chrome
sudo ln -sf /usr/bin/chromium /opt/google/chrome/chrome
echo "Chromium configured successfully."
chromium --version || true
"""

[[phase.runtime]]
name = "chromium-environment"
script = """
#!/bin/bash
# Write Chromium context for Claude
mkdir -p ~/.claude-vm/context
cat > ~/.claude-vm/context/chromium.txt <<EOF
Chromium browser available for headless web automation and testing
Chromium binary: $(which chromium 2>/dev/null || echo "not found")
EOF
"""

[[mcp]]
id = "chrome-devtools"
command = "npx"
args = ["-y", "chrome-devtools-mcp@latest", "--headless=true", "--isolated=true"]
